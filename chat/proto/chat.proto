syntax = "proto3";

package github.com.darialissi.msa_big_tech.chat;

option go_package = "github.com/darialissi/msa_big_tech/chat/pkg;chat";


// Создание личного чата
message CreateDirectChatRequest {
  string name = 1;
  repeated uint64 participant_ids = 2;
}

message CreateDirectChatResponse {
  uint64 chat_id = 1;
}

// Получение информации о чате
message GetChatRequest {
  uint64 chat_id = 1;
}

message GetChatResponse {
  Chat chat = 1;
}

// Получение списка чатов пользователя
message ListUserChatsRequest {
  uint64 user_id = 1;
}

message ListUserChatsResponse {
  repeated Chat chats = 1;
}

// Получение списка участников чата
message ListChatMembersRequest {
  uint64 chat_id = 1;
}

message ListChatMembersResponse {
  repeated ChatMember members = 1;
}

// Отправление сообщения
message SendMessageRequest {
  uint64 chat_id = 1;
  string text = 2;
}

message SendMessageResponse {
  Message message = 1;
}

// Получение истории сообщений чата
message ListMessagesRequest {
  uint64 chat_id = 1;
  uint64 limit = 2;
}

message ListMessagesResponse {
  repeated Message messages = 1;
}

// Серверный стрим новых сообщений
message StreamMessagesRequest {
  uint64 chat_id = 1;
}

message StreamMessagesResponse {
  Message stream = 1;
}

// Объекты
message Chat {
  uint64 chat_id = 1;
  string name = 2;
  uint64 creator_id = 3;
  repeated uint64 participant_ids = 4;
}

message ChatMember {
  uint64 user_id = 1;
  string role = 2;
}

message Message {
  uint64 message_id = 1;
  string text = 2;
  uint64 from_user_id = 3;
  uint64 to_chat_id = 4;
}