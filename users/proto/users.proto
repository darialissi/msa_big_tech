syntax = "proto3";

package github.com.darialissi.msa_big_tech.users;

import "buf/validate/validate.proto";

option go_package = "github.com/darialissi/msa_big_tech/users/pkg;users";


// Создание профиля
message CreateProfileRequest {
  string nickname = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.min_len = 3,
    (buf.validate.field).string.pattern = "^[a-zA-Z0-9_-]+$"
  ];
  string bio = 3 [(buf.validate.field).string.max_len = 500];
  string avatar_url = 4;
}

message CreateProfileResponse {
  UserProfile user_profile = 1;
}

// Обновление профиля
message UpdateProfileRequest {
  string user_id = 1 [
    (buf.validate.field).required = true
  ];
  string nickname = 2 [
    (buf.validate.field).string.min_len = 3,
    (buf.validate.field).string.pattern = "^[a-zA-Z0-9_-]+$"
  ];
  string bio = 3 [(buf.validate.field).string.max_len = 500];
  string avatar_url = 4;
}

message UpdateProfileResponse {
  UserProfile user_profile = 1;
}

// Получение профиля по id
message GetProfileByIDRequest {
  string user_id = 1 [
    (buf.validate.field).required = true
  ];
}

message GetProfileByIDResponse {
  UserProfile user_profile = 1;
}

// Получение профиля по nickname
message GetProfileByNicknameRequest {
  string nickname = 1 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.min_len = 3,
    (buf.validate.field).string.pattern = "^[a-zA-Z0-9_-]+$"
  ];
}

message GetProfileByNicknameResponse {
  UserProfile user_profile = 1;
}

// Поиск профилей по query
message SearchByQueryRequest {
  string query = 1;
  string limit = 2;
}

message SearchByQueryResponse {
  repeated UserProfile profiles = 1;
}

// Объекты
message UserProfile {
  string id = 1;
  string nickname = 2;
  string bio = 3;
  string avatar_url = 4;
}